# 经纬度如何计算之前的距离

# 关于经纬度

开始之前先解除一下对于经纬度的迷茫, 地球是在不停地绕地轴旋转（地轴是一根穿过地球南北两极和地球中心的假想线), 在地球中腰画一个与地轴垂直的大圆圈, 使圈上的每一点都和南北两极的距离相等, 这个圆圈就叫作“赤道”。我们把赤道定为纬度零度, 向南向北各为90度, 在赤道以南的叫南纬，在赤道以北的叫北纬。北极就是北纬90度, 南极就是南纬90度。纬度的高低也标志着气候的冷热, 如赤道和低纬度地地区无冬, 两极和高纬度地区无夏, 中纬度地区四季分明。

# 经纬度互换

经度 121.541752291 纬度 31.218171209

``` 将度转换为为度分秒: ``` 将121.541752291整数位不变取121(度), 用0.541752291*60=32.50513746, 取整数位32(分), 用0.50513746*60 = 30.3082476, 取整数位30(秒), 转化后为121度32分30秒

```将度分秒转化为度:``` 121度32分30秒 = 108 + (32/60) + (30/3600) = 108.54166666度

因为计算时小数位保留的原因，导致正反计算存在一定误差，但误差影响不是很大。1秒的误差就是几米的样子。

# 经纬度换算成米

纬度分为60分，每一分再分为60秒以及秒的小数。

纬度线投射在图上看似水平的平行线，但实际上是不同半径的圆。有相同特定纬度的所有位置都在同一个纬线上。

赤道的纬度为0°，将行星平分为南半球和北半球。

纬度是指某点与地球球心的连线和地球赤道面所成的线面角，其数值在0至90度之间。位于赤道以北的点的纬度叫北纬，记为N，位于赤道以南的点的纬度称南纬，记为S。

纬度数值在0至30度之间的地区称为低纬地区，纬度数值在30至60度之间的地区称为中纬地区，纬度数值在60至90度之间的地区称为高纬地区。

赤道、南回归线、北回归线、南极圈和北极圈是特殊的纬线。

纬度1秒的长度

地球的子午线总长度大约40008km。平均：

纬度1度 = 大约111km

纬度1分 = 大约1.85km

纬度1秒 = 大约30.9m

# 根据地球上任意两点的经纬度计算两点间的距离

地球是一个近乎标准的椭球体，它的赤道半径为6378.140千米，极半径为6356.755千米，平均半径6371.004千米。如果我们假设地球是一个完美的球体，那么它的半径就是地球的平均半径，记为R。如果以0度经线为基准，那么根据地球表面任意两点的经纬度就可以计算出这两点间的地表距离（这里忽略地球表面地形对计算带来的误差，仅仅是理论上的估算值）。设第一点A的经纬度为(LonA, LatA)，第二点B的经纬度为(LonB, LatB)，按照0度经线的基准，东经取经度的正值(Longitude)，西经取经度负值(-Longitude)，北纬取90-纬度值(90-Latitude)，南纬取90+纬度值(90+Latitude)，则经过上述处理过后的两点被计为(MLonA, MLatA)和(MLonB, MLatB)。那么根据三角推导，可以得到计算两点距离的如下公式：

```javascript
class calulateTwoLngLat{
    constructor(){
        this.earthRadius = 6371.004;
    }

    /**
     * [rad]
     * @param {*} d
     */
    static rad(d){
        return d * Math.PI / 180.0;
    }

    /**
     * [getDistance 得到距离]
     * @param {*} point1 [第一个经纬度]
     * @param {*} point2 [第二个经纬度]
     */
    getDistance(point1, point2){
        let radLng1 = calulateTwoLngLat.rad(point1.lng);
        let radLng2 = calulateTwoLngLat.rad(point2.lng);
        let radLat1 = calulateTwoLngLat.rad(point1.lat);
        let radLat2 = calulateTwoLngLat.rad(point2.lat);
        let a = radLat1 - radLat2;
        let b = radLng1 - radLng2;

        //计算a的次幂
        let aPow = Math.pow(Math.sin(a/2), 2);

        //计算b的次幂
        let bPow = Math.pow(Math.sin(b/2), 2);

        //计算两个纬度的余弦
        let latCos = Math.cos(radLat1)*Math.cos(radLat2);

        //计算平方根
        let sqrt = Math.sqrt(aPow + latCos * bPow);

        //计算反正弦值
        let asin = Math.asin(sqrt);

        let s = 2 * asin * this.earthRadius;

        //把数四舍五入为最接近的整数
        s = Math.round(s * 10000) / 10000;

        return s;
    }
}
```
